<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>Boletín {{ data.anio }} - P{{ data.periodo.numero }}</title>
<style>
  @page { size: A4; margin: 18mm 15mm 20mm; }
  body { font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #111; }
  h1,h2,h3 { margin: 0 0 6px; }
  .muted { color:#666; }
  .header { border-bottom: 2px solid #333; padding-bottom: 8px; margin-bottom: 12px; }
  .school { font-weight:bold; font-size:16px; }
  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  .box { border:1px solid #ccc; border-radius:6px; padding:8px; }
  table { width: 100%; border-collapse: collapse; margin-top: 8px; }
  th, td { border: 1px solid #ccc; padding: 6px 8px; vertical-align: top; }
  th { background: #f2f2f2; text-align: left; }
  .badge { display:inline-block; padding:2px 6px; border-radius:4px; background:#eef; border:1px solid #99c; }
  .footer { margin-top: 18px; font-size: 11px; color:#555; }
  ul { margin: 6px 0 0 18px; }
</style>
</head>
<body>

  <div class="header">
    <div class="school">Boletín académico {{ data.anio }}</div>
    <div>Periodo: <strong>{{ data.periodo.nombre }}</strong> (P{{ data.periodo.numero }})</div>
    <div class="muted">Generado el {{ data.generado_el }}</div>
  </div>

  <div class="grid-2">
    <div class="box">
      <h3>Estudiante</h3>
      <div><strong>{{ data.estudiante.nombre }} {{ data.estudiante.apellido }}</strong></div>
      {% if data.estudiante.tipo_documento %}
      <div>Documento: {{ data.estudiante.tipo_documento }} {{ data.estudiante.numero_documento }}</div>
      {% endif %}
      {% if data.estudiante.curso %}
      <div>Curso: {{ data.curso.nombre_curso }}</div>
      {% endif %}
    </div>

    <div class="box">
      <h3>Periodo</h3>
      <div>Año lectivo: {{ data.anio }}</div>
      <div>Fechas: {{ data.periodo.fecha_inicio }} — {{ data.periodo.fecha_fin }}</div>
      {% if data.periodo.activo %}
        <div class="badge">Periodo activo</div>
      {% else %}
        <div class="badge">Periodo finalizado</div>
      {% endif %}
    </div>
  </div>

  <h3 style="margin-top:14px;">Resumen por materia</h3>
  <table>
    <thead>
      <tr>
        <th>Materia</th>
        <th>Promedio</th>
        <th>Desempeño</th>
        <th>Inasistencias</th>
        <th>Observación</th>
      </tr>
    </thead>
    <tbody>
      {% for fila in data.materias %}
      <tr>
        <td>
          <strong>{{ fila.materia_nombre }}</strong>
          {% if fila.profesor %}<br><span class="muted">Docente: {{ fila.profesor }}</span>{% endif %}
        </td>
        <td>{{ fila.promedio }}</td>
        <td>{{ fila.desempeno }}</td>
        <td>{{ fila.inasistencias|default:"0" }}</td>
        <td>{{ fila.observacion_docente|default:"" }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% for fila in data.materias %}
    {% if fila.logros and fila.logros|length > 0 %}
      <h3 style="margin-top:12px;">Logros — {{ fila.materia_nombre }}</h3>
      <ul>
        {% for lg in fila.logros %}
          <li>{{ lg.orden }}. {{ lg.descripcion }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endfor %}

  {% if data.observaciones_generales %}
    <div class="box" style="margin-top:12px;">
      <h3>Observaciones generales</h3>
      <div>{{ data.observaciones_generales }}</div>
    </div>
  {% endif %}

  <div class="footer">
    * Documento informativo. Generado automáticamente por el sistema.
  </div>
</body>
</html>
